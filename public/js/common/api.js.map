{
  "version": 3,
  "sources": ["api.ts"],
  "sourcesContent": ["/**\n * Shared API helpers for ChatVibes Web UI.\n */\n\n/**\n * Returns the base URL for the API based on the current environment.\n */\nexport function getApiBaseUrl(): string {\n  if (window.location.hostname === 'localhost' || window.location.hostname === '127.0.0.1') {\n    return '';\n  }\n  return ''; // Use Firebase Hosting rewrites\n}\n\n/**\n * Performs a fetch request adding the stored authorization token.\n * Throws informative errors for non-OK responses.\n */\nexport async function fetchWithAuth(url: string, options: RequestInit = {}): Promise<Response> {\n  const appSessionToken = localStorage.getItem('app_session_token');\n  if (!appSessionToken) {\n    throw new Error('Not authenticated');\n  }\n\n  const headers: HeadersInit = {\n    'Content-Type': 'application/json',\n    ...options.headers,\n    'Authorization': `Bearer ${appSessionToken}`,\n  };\n\n  const response = await fetch(url, { ...options, headers });\n\n  if (!response.ok) {\n    if (response.status === 401) {\n      throw new Error('Authentication failed. Please log in again.');\n    }\n\n    let errorMessage = response.statusText;\n    try {\n      const errorData = await response.json() as { error?: string };\n      if (errorData.error) {\n        errorMessage = errorData.error;\n      }\n    } catch (_) {\n      // Ignore JSON parse errors and fall back to statusText.\n    }\n\n    throw new Error(`API Error: ${response.status} ${errorMessage}`);\n  }\n\n  return response;\n}\n"],
  "mappings": "AAOO,SAAS,gBAAwB;AACtC,MAAI,OAAO,SAAS,aAAa,eAAe,OAAO,SAAS,aAAa,aAAa;AACxF,WAAO;AAAA,EACT;AACA,SAAO;AACT;AAMA,eAAsB,cAAc,KAAa,UAAuB,CAAC,GAAsB;AAC7F,QAAM,kBAAkB,aAAa,QAAQ,mBAAmB;AAChE,MAAI,CAAC,iBAAiB;AACpB,UAAM,IAAI,MAAM,mBAAmB;AAAA,EACrC;AAEA,QAAM,UAAuB;AAAA,IAC3B,gBAAgB;AAAA,IAChB,GAAG,QAAQ;AAAA,IACX,iBAAiB,UAAU,eAAe;AAAA,EAC5C;AAEA,QAAM,WAAW,MAAM,MAAM,KAAK,EAAE,GAAG,SAAS,QAAQ,CAAC;AAEzD,MAAI,CAAC,SAAS,IAAI;AAChB,QAAI,SAAS,WAAW,KAAK;AAC3B,YAAM,IAAI,MAAM,6CAA6C;AAAA,IAC/D;AAEA,QAAI,eAAe,SAAS;AAC5B,QAAI;AACF,YAAM,YAAY,MAAM,SAAS,KAAK;AACtC,UAAI,UAAU,OAAO;AACnB,uBAAe,UAAU;AAAA,MAC3B;AAAA,IACF,SAAS,GAAG;AAAA,IAEZ;AAEA,UAAM,IAAI,MAAM,cAAc,SAAS,MAAM,IAAI,YAAY,EAAE;AAAA,EACjE;AAEA,SAAO;AACT;",
  "names": []
}
